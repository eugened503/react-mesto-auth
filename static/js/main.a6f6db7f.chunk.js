(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{18:function(e,t,n){e.exports=n.p+"static/media/logo.855a8c98.svg"},23:function(e,t,n){e.exports=n.p+"static/media/Union.e38b395c.svg"},24:function(e,t,n){e.exports=n.p+"static/media/mistake.4072126c.svg"},27:function(e,t,n){e.exports=n(38)},32:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(17),c=n.n(r),i=(n(32),n(25)),l=n(2),s=n(18),u=n.n(s),p=n(1),m=n(7);var d=function(e){var t=Object(p.h)().pathname,n="".concat("/sign-in"===t?"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f":"\u0412\u043e\u0439\u0442\u0438"),a="".concat("/sign-in"===t?"/sign-up":"/sign-in");return o.a.createElement("header",{className:"header"},o.a.createElement("img",{src:u.a,alt:"\u043b\u043e\u0433\u043e\u0442\u0438\u043f \u041c\u0435\u0441\u0442\u043e-\u0420\u043e\u0441\u0441\u0438\u044f",className:"header__logo"}),o.a.createElement("div",{className:"header__register-button-container"},e.loggedIn?o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",{id:"mail",className:"header__element header__element-right header__block"},e.userData.email),o.a.createElement(m.b,{to:"#",onClick:e.onSignOut,className:"header__block header__element header__element-top"},"\u0412\u044b\u0439\u0442\u0438")):o.a.createElement(m.b,{to:a,className:"header__block header__element"},n)))},_=n(20);var f=function(e){var t=e.card.owner._id===e.currentUser._id,n="card__trash-button_hidden' ".concat(t?"card__trash-button":null),a=e.card.likes.some((function(t){return t._id===e.currentUser._id})),r="card__like-button ".concat(a?"card__like-button_active":"");return o.a.createElement("div",{className:"card"},o.a.createElement("img",{className:"card__image",alt:"\u0432\u0430\u0448\u0435 \u0444\u043e\u0442\u043e",id:"myImg",src:e.card.link,onClick:function(){e.onCardClick(e.card)}}),o.a.createElement("h2",{className:"card__title"},e.card.name),o.a.createElement("button",{type:"button",className:n,onClick:function(){e.onCardDelete(e.card)},"aria-label":"\u043a\u043e\u0440\u0437\u0438\u043d\u0430"}),o.a.createElement("button",{type:"button",className:r,onClick:function(){e.onCardLike(e.card)},"aria-label":"\u043b\u0430\u0439\u043a"}),o.a.createElement("h2",{className:"card__like-sum"},e.card.likes.length>0?"".concat(e.card.likes.length):0," "))},g=o.a.createContext();var h=function(e){var t=o.a.useContext(g);return o.a.createElement("main",{className:"content"},o.a.createElement("section",{className:"profile"},o.a.createElement("img",Object(_.a)({src:t.avatar,alt:t.name,className:"profile__image"},"alt","\u041f\u043e\u0440\u0442\u0440\u0435\u0442 \u0430\u0432\u0442\u043e\u0440\u0430")),o.a.createElement("div",{className:"header__pencil",onClick:e.onEditAvatar}),o.a.createElement("div",{className:"profile-info"},o.a.createElement("div",{className:"information"},o.a.createElement("h1",{className:"profile-info__title"},t.name),o.a.createElement("p",{className:"profile-info__subtitle"},t.about)),o.a.createElement("button",{type:"button",className:"profile-info__button","aria-label":"\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",onClick:e.onEditProfile})),o.a.createElement("button",{type:"button",className:"profile__add-button","aria-label":"\u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0444\u043e\u0442\u043e",onClick:e.onAddPlace})),o.a.createElement("section",{className:"cards"},e.cards.map((function(n){return o.a.createElement(f,{card:n,key:n._id,onCardClick:e.onCardClick,currentUser:t,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete})}))))};var E=function(){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))};var b=function(e){return o.a.createElement("section",{className:"popup popup-enlargement ".concat(e.isOpen&&"popup_opened")},o.a.createElement("form",{className:"popup__container-enlargement",name:"container",method:"post",action:"#"},o.a.createElement("img",{src:e.card.link,alt:"\u0432\u0430\u0448\u0435 \u0444\u043e\u0442\u043e",className:"popup__img-enlargement"}),o.a.createElement("h2",{className:"popup__title popup__title-enlargement"},e.card.name),o.a.createElement("button",{type:"button",className:"popup__close-button popup__close-button-enlargement","aria-label":"\u0437\u0430\u043a\u0440\u044b\u0442\u044c",onClick:e.onClose})))};var v=function(e){return o.a.createElement("section",{className:e.isOpen?"popup popup-".concat(e.name," popup_opened"):"popup popup-".concat(e.name)},o.a.createElement("form",{onSubmit:e.onSubmit,className:"popup__container popup__form"},o.a.createElement("h2",{className:"popup__title"},e.title),e.children,o.a.createElement("button",{type:"submit",className:"popup__btn popup__button","aria-label":"\u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",id:"active-passive-btn"},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),o.a.createElement("button",{type:"button",className:"popup__close-button","aria-label":"\u0437\u0430\u043a\u0440\u044b\u0442\u044c",onClick:e.onClose})))},k=n(21),N=n(22),C=new(function(){function e(t){var n=t.baseUrl,a=t.authorization;Object(k.a)(this,e),this._baseUrl=n,this._authorization=a}return Object(N.a)(e,[{key:"_fetch",value:function(e,t){return t.headers={authorization:this._authorization,"Content-Type":"application/json"},fetch(this._baseUrl+e,t).then((function(e){return e.ok?e.json():Promise.reject(e.status)}))}},{key:"getInitialCards",value:function(e){return this._fetch(e,{method:"GET"})}},{key:"getUserInfoServer",value:function(e){return this._fetch(e,{method:"GET"})}},{key:"sendUserInfo",value:function(e,t){return this._fetch(e,{method:"PATCH",body:JSON.stringify({name:"".concat(t.name),about:"".concat(t.about)})})}},{key:"sendCard",value:function(e,t){return this._fetch(e,{method:"POST",body:JSON.stringify({name:"".concat(t.name),link:"".concat(t.link)})})}},{key:"deleteCard",value:function(e){return this._fetch(e,{method:"DELETE"})}},{key:"putLikeCard",value:function(e){return this._fetch(e,{method:"PUT"})}},{key:"deleteLikeCard",value:function(e){return this._fetch(e,{method:"DELETE"})}},{key:"changeAvatar",value:function(e,t){return this._fetch(e,{method:"PATCH",body:JSON.stringify({avatar:"".concat(t.avatar)})})}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-12",authorization:"b6efac6e-fe72-4acc-8171-d974e56a542c"});var O=function(e){var t=o.a.useState(""),n=Object(l.a)(t,2),a=n[0],r=n[1],c=o.a.useState(""),i=Object(l.a)(c,2),s=i[0],u=i[1],p=o.a.useContext(g);return o.a.useEffect((function(){r(p.name),u(p.about)}),[p]),o.a.createElement(v,{name:"profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:a,about:s})},isOpen:e.isOpen,onClose:e.onClose},o.a.createElement("input",{defaultValue:a,onChange:function(e){r(e.target.value)},id:"name-input",type:"text",required:!0,placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f",name:"name",className:"popup__text popup__text_text-margin popup__input",minLength:"2",maxLength:"40",pattern:"[\u0410-\u042f\u0430-\u044fA-Za-z -]{2,40}"}),o.a.createElement("span",{id:"name-input-error",className:"popup__input-error"}),o.a.createElement("input",{defaultValue:s,onChange:function(e){u(e.target.value)},id:"work-input",type:"text",required:!0,placeholder:"\u0420\u043e\u0434 \u0434\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438",name:"about",className:"popup__text popup__text_work-margin popup__input",minLength:"2",maxLength:"200"}),o.a.createElement("span",{id:"work-input-error",className:"popup__input-error"}))};var y=function(e){var t=o.a.useRef();return o.a.createElement(v,{isOpen:e.isOpen,onClose:e.onClose,name:"avatar",onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})},title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440"},o.a.createElement("input",{ref:t,type:"url",id:"link-input",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,defaultValue:"",name:"avatar",className:"popup__text popup__text_work-margin popup__link popup__input popup__text_avatar",pattern:"^(https?:\\/\\/)?([\\w-]{1,32}\\.[\\w-]{1,32})[^\\s@]*$"}),o.a.createElement("span",{id:"link-input-error",className:"popup__input-error"}))};var j=function(e){var t=o.a.useRef(),n=o.a.useRef();return o.a.createElement(v,{isOpen:e.isOpen,onClose:e.onClose,name:"foto",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",onSubmit:function(a){a.preventDefault(),e.onAddPlace({name:t.current.value,link:n.current.value})}},o.a.createElement("input",{ref:t,type:"text",id:"title-input",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",required:!0,defaultValue:"",name:"title",className:"popup__text popup__text_text-margin popup__name popup__input",minLength:"1",maxLength:"30"}),o.a.createElement("span",{id:"title-input-error",className:"popup__input-error"}),o.a.createElement("input",{ref:n,type:"url",id:"link-input",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,defaultValue:"",name:"link",className:"popup__text popup__text_work-margin popup__link popup__input",pattern:"^(https?:\\/\\/)?([\\w-]{1,32}\\.[\\w-]{1,32})[^\\s@]*$"}),o.a.createElement("span",{id:"link-input-error",className:"popup__input-error"}))},S=n(23),w=n.n(S);var x=function(e){return o.a.createElement("section",{className:e.isOpen?"popup popup_opened":"popup "},o.a.createElement("form",{className:"popup__container popup__form"},o.a.createElement("img",{src:e.logo,alt:"\u043b\u043e\u0433\u043e\u0442\u0438\u043f \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438",className:"popup__logo"}),o.a.createElement("h2",{className:"popup__title-reg"},e.title),o.a.createElement("button",{type:"button",className:"popup__close-button","aria-label":"\u0437\u0430\u043a\u0440\u044b\u0442\u044c",onClick:e.onClose})))};var L=function(e){return o.a.createElement(x,{isOpen:e.isOpen,onClose:e.onClose,title:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!",logo:w.a})},U=n(24),A=n.n(U);var I=function(e){return o.a.createElement(x,{isOpen:e.isOpen,onClose:e.onClose,title:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a!\r \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.",logo:A.a})};var T=function(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)(""),s=Object(l.a)(i,2),u=s[0],p=s[1],d=function(t){t.preventDefault(),e.onRegister(r,u)};return o.a.createElement("div",{className:"login"},o.a.createElement("p",{className:"login__welcome"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),o.a.createElement("form",{onSubmit:d,className:"login__form"},o.a.createElement("input",{className:"login__field login__field_color",id:"email",name:"email",type:"email",value:r,onChange:function(e){return c(e.target.value)},required:!0,placeholder:"email"}),o.a.createElement("input",{className:"login__field login__field_margin login__field_color",id:"password",name:"password",type:"password",value:u,onChange:function(e){return p(e.target.value)},required:!0,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"}),o.a.createElement("div",{className:"login__button-container"},o.a.createElement("button",{type:"submit",onSubmit:d,className:"login__button"},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"))),o.a.createElement("div",{className:"login__signup"},o.a.createElement("p",{className:"signup__link"},"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?"),o.a.createElement(m.b,{className:"signup__link",to:"/sign-in",onClick:e.hideEntrance},"\u0412\u043e\u0439\u0442\u0438")))};var D=function(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)(""),s=Object(l.a)(i,2),u=s[0],p=s[1];return o.a.createElement("div",{className:"login"},o.a.createElement("p",{className:"login__welcome"},"\u0412\u0445\u043e\u0434"),o.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.onLogin(r,u)},className:"login__form"},o.a.createElement("input",{className:"login__field login__field_color",id:"email",name:"email",type:"email",value:r,onChange:function(e){return c(e.target.value)},required:!0,placeholder:"email"}),o.a.createElement("input",{className:"login__field login__field_margin login__field_color",id:"password",name:"password",type:"password",value:u,onChange:function(e){return p(e.target.value)},required:!0,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"}),o.a.createElement("div",{className:"login__button-container"},o.a.createElement("button",{to:"/",type:"submit",className:"login__button",onClick:e.showLoginEmail},"\u0412\u043e\u0439\u0442\u0438"))),o.a.createElement("div",{className:"login__signup"},o.a.createElement("p",{className:"signup__link"},"\u0415\u0449\u0451 \u043d\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?"),o.a.createElement(m.b,{to:"/sign-up",className:"signup__link",onClick:e.closeRegistration},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f")))},P="https://auth.nomoreparties.co",q=n(26),z=function(e){var t=e.component,n=Object(q.a)(e,["component"]);return o.a.createElement(p.b,null,(function(){return n.loggedIn?o.a.createElement(t,n):o.a.createElement(p.a,{to:"/sign-in"})}))};var J=function(){var e=o.a.useState({}),t=Object(l.a)(e,2),n=t[0],a=t[1],r=o.a.useState([]),c=Object(l.a)(r,2),s=c[0],u=c[1],m=o.a.useState(!1),_=Object(l.a)(m,2),f=_[0],k=_[1],N=o.a.useState(!1),S=Object(l.a)(N,2),w=S[0],x=S[1],U=o.a.useState(!1),A=Object(l.a)(U,2),q=A[0],J=A[1],R=o.a.useState(!1),V=Object(l.a)(R,2),B=V[0],G=V[1],$=o.a.useState({}),F=Object(l.a)($,2),H=F[0],M=F[1],W=o.a.useState(!1),Z=Object(l.a)(W,2),K=Z[0],Q=Z[1],X=o.a.useState(!1),Y=Object(l.a)(X,2),ee=Y[0],te=Y[1],ne=o.a.useState(!1),ae=Object(l.a)(ne,2),oe=ae[0],re=ae[1],ce=o.a.useState({}),ie=Object(l.a)(ce,2),le=ie[0],se=ie[1],ue=Object(p.g)();function pe(){k(!1),x(!1),J(!1),G(!1),Q(!1),te(!1)}return o.a.useEffect((function(){C.getUserInfoServer("/users/me").then((function(e){a(e)})).catch((function(e){return console.log(e)})),C.getInitialCards("/cards").then((function(e){u(e)})).catch((function(e){return console.log(e)}))}),[]),o.a.useEffect((function(){window.addEventListener("keydown",(function(e){"Escape"===e.key&&pe()}))}),[]),o.a.useEffect((function(){!function(){if(localStorage.getItem("jwt")){var e=localStorage.getItem("jwt");(t=e,fetch("".concat(P,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then((function(e){return e.ok?e.json():e.json().then((function(e){console.log(e.message)}))})).then((function(e){return e}))).then((function(e){e&&(se({_id:e.data._id,email:e.data.email}),re(!0),ue.push("/"))})).catch((function(e){return console.log(e)}))}var t}()}),[oe]),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"page"},o.a.createElement(g.Provider,{value:n},o.a.createElement(d,{loggedIn:oe,userData:le,setUserData:se,onSignOut:function(){re(!1),se(""),localStorage.removeItem("jwt"),ue.push("/sign-in")}}),o.a.createElement(p.d,null,o.a.createElement(z,{exact:!0,path:"/",loggedIn:oe,component:h,onEditProfile:function(){k(!0)},onAddPlace:function(){x(!0)},onEditAvatar:function(){J(!0)},onCardClick:function(e){G(!0),M(e)},cards:s,onCardLike:function(e){(e.likes.some((function(e){return e._id===n._id}))?C.deleteLikeCard("/cards/likes/".concat(e._id)):C.putLikeCard("/cards/likes/".concat(e._id))).then((function(t){var n=s.map((function(n){return n._id===e._id?t:n}));u(n)})).catch((function(e){return console.log(e)}))},onCardDelete:function(e){C.deleteCard("/cards/".concat(e._id)).then((function(){var t=s.filter((function(t){return t._id!==e._id}));u(t)})).catch((function(e){return console.log(e)}))}}),o.a.createElement(p.b,{path:"/sign-up"},o.a.createElement(T,{onRegister:function(e,t){(function(e,t){return fetch("".concat(P,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){if(400!==e.status)return e.json();throw new Error("\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u043e\u0434\u043d\u043e \u0438\u0437 \u043f\u043e\u043b\u0435\u0439")})).catch((function(e){return console.log(e)}))})(e,t).then((function(e){e?(Q(!0),ue.push("/sign-in")):(te(!0),console.log("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430."))})).catch((function(e){return console.log(e)}))}})),o.a.createElement(p.b,{path:"/sign-in"},o.a.createElement(D,{onLogin:function(e,t){(function(e,t){return fetch("".concat(P,"/signin"),{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({email:e,password:t})}).then((function(e){try{if(200===e.status)return e.json();if(400===e.status)return console.log("\u041e\u0434\u043d\u043e \u0438\u0437 \u043f\u043e\u043b\u0435\u0439 \u043d\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043e");if(401===e.status)return console.log("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441 \u0442\u0430\u043a\u0438\u043c email \u043d\u0435  \u043d\u0430\u0439\u0434\u0435\u043d")}catch(t){return t}})).then((function(e){if(e)return localStorage.setItem("jwt",e.token),e.token})).catch((function(e){return console.log(e)}))})(e,t).then((function(e){return e?e?(re(!0),void ue.push("/")):void 0:console.log("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a")})).catch((function(e){return console.log(e)}))}})),o.a.createElement(p.b,null,oe?o.a.createElement(p.a,{to:"/"}):o.a.createElement(p.a,{to:"/sign-in"}))),o.a.createElement(L,{isOpen:K,onClose:pe}),o.a.createElement(I,{isOpen:ee,onClose:pe}),o.a.createElement(y,{isOpen:q,onClose:pe,onUpdateAvatar:function(e){C.changeAvatar("/users/me/avatar",e).then((function(e){a(e),pe()})).catch((function(e){return console.log(e)}))}}),o.a.createElement(O,{isOpen:f,onClose:pe,onUpdateUser:function(e){C.sendUserInfo("/users/me",e).then((function(e){a(e),pe()})).catch((function(e){return console.log(e)}))}}),o.a.createElement(j,{isOpen:w,onClose:pe,onAddPlace:function(e){C.sendCard("/cards",e).then((function(e){u([e].concat(Object(i.a)(s))),pe()})).catch((function(e){return console.log(e)}))}}),o.a.createElement(v,{name:"deleting-card",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?"}),o.a.createElement(b,{card:H,isOpen:B,onClose:pe}),o.a.createElement(E,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(m.a,null,o.a.createElement(J,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[27,1,2]]]);
//# sourceMappingURL=main.a6f6db7f.chunk.js.map